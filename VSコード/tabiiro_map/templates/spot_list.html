{% extends "base.html" %}

{% block title %}観光地一覧 | 旅色マップ{% endblock %}

{% block main_content %}
<div class="spot-list-container">
    <h1>観光地一覧</h1>

    <!-- 絞り込みエリア -->
    <form method="GET" action="{{ url_for('spot.spot_list') }}" class="filter-form">
        <select name="prefecture" class="pref-select">
            <option value="">全ての都道府県</option>
            {% for p in prefectures %}
                <option value="{{ p }}" {% if selected_pref == p %}selected{% endif %}>
                    {{ p }}
                </option>
            {% endfor %}
        </select>

        <button type="submit" class="filter-button">絞り込み</button>

        {% if selected_pref %}
            <a href="{{ url_for('spot.spot_list') }}" class="reset-button">リセット</a>
        {% endif %}

        <button type="button"
                onclick="location.href='{{ url_for('spot.spot_register') }}'"
                class="filter-button">
            新規追加
        </button>
    </form>

    {% if spots %}
        <div class="spot-list">

            {% for spot in spots %}
            <div class="spot-card"
                 onclick="location.href='{{ url_for('spot.spot_detail', spot_id=spot.spot_id) }}'">

                {% if spot.photos %}
                    <img src="{{ url_for('static', filename='uploads/' + spot.photos[-1].filename) }}"
                         alt="{{ spot.name }}">
                {% else %}
                    <div class="no-photo">写真なし</div>
                {% endif %}

                <div class="spot-info">
                    <h2>{{ spot.name }}</h2>
                    <p><strong>訪問日:</strong> {{ spot.visit_date }}</p>
                </div>

            </div>
            {% endfor %}

        </div>
    {% else %}
        <p>まだ登録された観光地はありません。</p>
    {% endif %}
</div>
{% endblock %}
