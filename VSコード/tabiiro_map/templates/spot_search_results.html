{% extends "base.html" %}
{% block title %}検索結果 | 旅色マップ{% endblock %}

{% block main_content %}
<div class="register-container">

    <!-- ここに検索フォームを追加 -->
    <form method="GET" action="{{ url_for('spot_search_results') }}">

        <label for="prefecture">都道府県:</label>
        <select name="prefecture" id="prefecture">
            <option value="">すべて</option>
            {% for pref in prefectures %}
                <option value="{{ pref }}" {% if request.args.get('prefecture') == pref %}selected{% endif %}>
                    {{ pref }}
                </option>
            {% endfor %}
        </select>

        <br><br>

        <label for="keyword">キーワード:</label>
        <input type="text" name="keyword" id="keyword" value="{{ request.args.get('keyword', '') }}">

        <br><br>

        <button type="submit">再検索</button>
    </form>

    <hr>

    <h1>検索結果（{{ results|length }}件）</h1>

    {% if results %}
        <ul>
            {% for spot in results %}
                <li>
                    <strong>{{ spot.spot_name }}</strong><br>
                    都道府県：{{ spot.pref_name }}<br>
                    市区町村：{{ spot.city }}<br>
                    カテゴリ：{{ spot.category }}<br>
                    説明：{{ spot.description }}
                </li>
                <button class="bookmark-btn"
                    data-type="spot"
                    data-id="{{ spot.spot_id }}"
                    data-title="{{ spot.name }}"
                    data-url="/spot/{{ spot.spot_id }}">
                    ☆ ブックマーク
                </button>
            {% endfor %}
        </ul>
    {% else %}
        <p>条件に一致するスポットは見つかりませんでした。</p>
    {% endif %}

    <a href="{{ url_for('spot_search') }}">検索フォームに戻る</a>
</div>
{% endblock %}
