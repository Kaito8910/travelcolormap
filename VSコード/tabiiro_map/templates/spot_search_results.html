{% extends "base.html" %}
{% block title %}検索結果 | 旅色マップ{% endblock %}

{% block main_content %}
<div class="register-container">

    <!-- 検索フォーム -->
<form method="GET"
        action="{{ url_for('spot.spot_search_results') }}"
        class="search-form-inline">

    <label for="prefecture">都道府県:</label>
    <select name="prefecture" id="prefecture">
        <option value="">すべて</option>
        {% for pref in prefectures %}
            <option value="{{ pref }}"
                {% if selected_pref == pref %}selected{% endif %}>
                {{ pref }}
            </option>
        {% endfor %}
    </select>

    <label for="keyword">キーワード:</label>
    <input type="text"
            name="keyword"
            id="keyword"
            value="{{ request.args.get('keyword', '') }}">

    <button type="submit">再検索</button>
</form>


    <hr>

    <h1>検索結果（{{ results|length }}件）</h1>

    {% if results %}
        <ul>
            {% for spots in results %}
                <li class="spots-item">
    {% if spots.image_url %}
        <img src="{{ url_for('static', filename=spots.image_url.replace('static/', '')) }}"
                alt="{{ spots.spot_name }}"
                class="spots-image">
    {% endif %}

    <div class="spot-info">
        <strong>{{ spots.spot_name }}</strong><br>
        都道府県：{{ spots.pref_name }}<br>
        市区町村：{{ spots.city }}<br>
        カテゴリ：{{ spots.category }}<br>
        説明：{{ spots.description }}
    </div>

    {% if session.get('logged_in') %}
        <button class="bookmark-btn"
            data-type="spots"
            data-id="{{ spots.spot_id }}"
            data-title="{{ spots.spot_name }}"
            data-url="{{ url_for('spot.spot_detail', spot_id=spots.spot_id) }}">
            ☆ ブックマーク
        </button>
    {% endif %}
</li>
            {% endfor %}
        </ul>
    {% else %}
        <p>条件に一致するスポットは見つかりませんでした。</p>
    {% endif %}
</div>
{% endblock %}
